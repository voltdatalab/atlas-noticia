I"˙@<h3 id="sobre-a-documenta√ß√£o">Sobre a documenta√ß√£o</h3>

<p>Seja bem vindo √† documenta√ß√£o da API do Atlas da Not√≠cia.</p>

<p>O <strong>Atlas da Not√≠cia</strong> √© uma iniciativa para mapear ve√≠culos produtores de not√≠cias ‚Äì especialmente de jornalismo local ‚Äì no territ√≥rio brasileiro.</p>

<p>Esta √© uma API que implementa o protocolo <code class="language-plaintext highlighter-rouge">REST</code> para a comunica√ß√£o com os sistemas com uma autentica√ß√£o do tipo JWT para a seguran√ßa das aplica√ß√µes.</p>

<p>Esta p√°gina cont√©m aspectos mais t√©cnicos sobre a API e seu uso. Caso ainda esteja no come√ßo da sua experi√™ncia com a APIs e de compreens√£o de <em>endpoints</em>, por favor recorra primeiro a <a href="../utilizarAPI">este documento</a>, que detalha o passo a passo inicial para usar esse recurso.</p>

<h3 id="autentica√ß√£o">Autentica√ß√£o</h3>

<p>A API conta com o padr√£o JWT para autenticar seus usu√°rios.</p>

<p>Para que voc√™ possa autenticar, √© necess√°rio ter um usu√°rio cadastrado no nosso sistema. Caso ainda n√£o tenha, <a href="https://api.atlas.jor.br/register">fa√ßa cadastro aqui</a>.</p>

<p>Para acessar os endpoints da API voc√™ deve usar o token como Bearer, incluindo-o no Header de sua requisi√ß√£o.</p>

<p>Com o usu√°rio cadastrado, voc√™ pode realizar uma solicita√ß√£o <code class="language-plaintext highlighter-rouge">POST</code> na nossa API com as seguintes informa√ß√µes:</p>

<h4 id="endpoint">Endpoint</h4>

<p><code class="language-plaintext highlighter-rouge">https://api.atlas.jor.br/api/v1/auth/login</code></p>

<h4 id="json-request">JSON Request</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    {
    "email": "seu@email",
    "password": "sua senha"
    }
</code></pre></div></div>

<h4 id="resposta-com-o-token-ser√°-enviada-para-voc√™">Resposta com o token ser√° enviada para voc√™</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    {
        "access_token": "seu_token",
        "token_type": "bearer",
        "expires_in": 3600
    }
</code></pre></div></div>

<h4 id="renovando-o-token">Renovando o token</h4>

<p>Para renovar o token da sua aplica√ß√£o, basta realizar o refresh do mesmo pela API. Neste Endpoint, voc√™ vai realizar um POST passando o token como Bearer token no Header da Requisi√ß√£o de acordo com o exemplo abaixo:</p>

<h4 id="endpoint-1">Endpoint</h4>

<p><code class="language-plaintext highlighter-rouge">https://api.atlas.jor.br/api/v1/auth/refresh</code></p>

<p>Resposta com o novo token ser√° enviada para voc√™, no mesmo formanto do primeiro token.</p>

<h4 id="documenta√ß√£o-do-json">Documenta√ß√£o do JSON</h4>

<table>
  <thead>
    <tr>
      <th>COLUNA</th>
      <th>VALOR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>access_token</td>
      <td>Token de acesso para a API</td>
    </tr>
    <tr>
      <td>token_type</td>
      <td>Tipo de token</td>
    </tr>
    <tr>
      <td>expires_in</td>
      <td>Tempo em segundos de validade do token</td>
    </tr>
  </tbody>
</table>

<hr />

<h3 id="endpoints-de-dados">Endpoints de dados</h3>

<p>Endpoints s√£o as URL‚Äôs que a API prov√™ para o retorno dos dados. A API do Atlas da Not√≠cia possui diversos endpoints, cada um retornando um conjunto diferente de informa√ß√µes.</p>

<p>A URL base da aplica√ß√£o √©: <code class="language-plaintext highlighter-rouge">https://api.atlas.jor.br/</code></p>

<p>A aplica√ß√£o tem um controle de vers√£o, caso a API seja atualizada de maneira a impactar nas aplica√ß√µes-clientes. A vers√£o √© sempre colocada ap√≥s a URL base: <code class="language-plaintext highlighter-rouge">https://api.atlas.jor.br/api/vers√£o</code></p>

<p>A url ent√£o deve ficar no seguinte formato: <code class="language-plaintext highlighter-rouge">https://api.atlas.jor.br/api/v1</code></p>

<p>Ap√≥s a vers√£o, √© necess√°rio incluir o endpoint desejado para realizar a busca.</p>

<h4 id="filtros">Filtros</h4>

<p>A API √© preparada para receber filtros de acordo com os campos desejados na consulta. Para facilitar a descoberta dos campos, a aplica√ß√£o disp√µe para cada endpoint, um m√©todo que retorna os campos dispon√≠veis.</p>

<p>Os tipos de filtros dispon√≠veis s√£o:</p>

<table>
  <thead>
    <tr>
      <th>TIPO</th>
      <th>REPRESENTA√á√ÉO</th>
      <th>DESCRI√á√ÉO</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Equalidade</td>
      <td>Par√¢metro padr√£o na URL</td>
      <td>√â um par√¢metro comum na URL, baseado nos campos disn√≠vies no endpoint</td>
    </tr>
    <tr>
      <td>Parcialidade</td>
      <td>lk</td>
      <td>√â o LIKE do SQL, onde temos uma busca parcial de um conte√∫do do tipo String</td>
    </tr>
    <tr>
      <td>Agrupamento</td>
      <td>Par√¢metro do tipo array na URL</td>
      <td>√â o IN do SQL. Para que o sistema filtre nesse formato, √© necess√°rio enviar como array.</td>
    </tr>
    <tr>
      <td>Maior Igual</td>
      <td>gt</td>
      <td>Define o in√≠cio de um range de dados.</td>
    </tr>
    <tr>
      <td>Menor Igual</td>
      <td>lt</td>
      <td>Define o fim de um range de dados.</td>
    </tr>
  </tbody>
</table>

<h4 id="exemplos-de-filtros">Exemplos de Filtros</h4>

<ul>
  <li>
    <p>Equalidade: <code class="language-plaintext highlighter-rouge">https://api.atlas.jor.br/api/v1/endpoint?parametro=valor</code></p>
  </li>
  <li>
    <p>Parcialiade: <code class="language-plaintext highlighter-rouge">https://api.atlas.jor.br/api/v1/endpoint?parametro[lk]=valor</code></p>
  </li>
  <li>
    <p>Agrupamento: <code class="language-plaintext highlighter-rouge">https://api.atlas.jor.br/api/v1/endpoint?parametro[]=valor1¬∂metro[]=valor2...</code></p>
  </li>
  <li>
    <p>Maior Igual: <code class="language-plaintext highlighter-rouge">https://api.atlas.jor.br/api/v1/endpoint?parametro[gt]=valor</code></p>
  </li>
  <li>
    <p>Menor Igual: <code class="language-plaintext highlighter-rouge">https://api.atlas.jor.br/api/v1/endpoint?parametro[lt]=valor</code></p>
  </li>
  <li>
    <p>Between: <code class="language-plaintext highlighter-rouge">https://api.atlas.jor.br/api/v1/endpoint?parametro[gt]=valor¬∂metro[lt]=valor</code></p>
  </li>
</ul>

<h4 id="campos">Campos</h4>

<p>A API conta com a possibilidade de filtrar quais campos ser√£o retornados. Para isso, √© necess√°rio enviar um par√¢metro na url chamado <code class="language-plaintext highlighter-rouge">field</code>.</p>

<p>Exemplo: <code class="language-plaintext highlighter-rouge">https://api.atlas.jor.br/api/v1/endpoint?field[]=campo_1&amp;field[]=campo_2&amp;...</code></p>

<hr />

<h3 id="atlas-analytic">Atlas Analytic</h3>

<p>Endpoint que retorna uma lista de ve√≠culos de acordo com os filtros.</p>

<h4 id="retorna-os-dados">Retorna os dados:</h4>

<p>GET: <code class="language-plaintext highlighter-rouge">/data/analytic</code></p>

<h4 id="retorna-as-defini√ß√µes">Retorna as defini√ß√µes:</h4>

<p>GET: <code class="language-plaintext highlighter-rouge">/data/analytic/definitions</code></p>

<p>Retorno (Defini√ß√µes):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    [
      "id",
      "nome_veiculo",
      "fonte",
      "segmento",
      "cidade",
      "cod_mun_ibge",
      "estado",
      "regiao",
      "address",
      "annotations",
      "email",
      "num_funcionarios",
      "periodicity",
      "another_periodicity",
      "eh_jornal",
      "eh_site_pago",
      "data_fechamento"
    ]
</code></pre></div></div>

<h4 id="retorno-do-endpoint-amostra">Retorno do endpoint (amostra)</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    [
      {
        "id": 5114,
        "nome_veiculo": "A GAZETA DO ACRE",
        "fonte": "Atlas da Not√≠cia",
        "segmento": "Impresso",
        "cidade": "Rio Branco",
        "cod_mun_ibge": "1200401",
        "estado": "AC",
        "regiao": "Norte",
        "address": "Av Antonio da Rocha Viana, 1503. Vila Ivonte",
        "annotations": null,
        "email": "agazeta.jornal@gmail.com",
        "num_funcionarios": "6 a 9 colaboradores",
        "periodicity": "daily",
        "another_periodicity": null,
        "eh_jornal": 1,
        "eh_site_pago": 0,
        "data_fechamento": null,
        "business_models": [
          {
            "id": 1,
            "name": "Assinatura\/paywall",
            "created_at": "2019-10-29 00:21:45",
            "updated_at": "2019-10-29 00:21:45",
            "deleted_at": null,
            "pivot": {
              "media_id": 5114,
              "business_model_id": 1
            }
          }
        ],
        "features": [
          {
            "id": 4,
            "name": "Notici√°rio em tempo real",
            "created_at": "2019-10-29 00:21:45",
            "updated_at": "2019-10-29 00:21:45",
            "deleted_at": null,
            "pivot": {
              "media_id": 5114,
              "feature_id": 4
            }
          },
          {
            "id": 5,
            "name": "Opini√£o\/colunistas",
            "created_at": "2019-10-29 00:21:45",
            "updated_at": "2019-10-29 00:21:45",
            "deleted_at": null,
            "pivot": {
              "media_id": 5114,
              "feature_id": 5
            }
          },
          {
            "id": 7,
            "name": "Possui alguma edi√ß√£o impressa",
            "created_at": "2019-10-29 00:21:45",
            "updated_at": "2019-10-29 00:21:45",
            "deleted_at": null,
            "pivot": {
              "media_id": 5114,
              "feature_id": 7
            }
          },
          {
            "id": 8,
            "name": "Redes sociais",
            "created_at": "2019-10-29 00:21:45",
            "updated_at": "2019-10-29 00:21:45",
            "deleted_at": null,
            "pivot": {
              "media_id": 5114,
              "feature_id": 8
            }
          }
        ],
        "collaborators": [
          {
            "id": 3,
            "name": "Estudante",
            "created_at": "2019-10-29 00:21:45",
            "updated_at": "2019-10-29 00:21:45",
            "deleted_at": null,
            "pivot": {
              "media_id": 5114,
              "collaborator_id": 3
            }
          }
        ],
        "media_channels": [
          {
            "id": 249,
            "channel_id": 1,
            "link": "https:\/\/agazetadoacre.com\/",
            "media_id": 5114,
            "created_at": "2019-10-29 00:24:32",
            "updated_at": "2019-10-29 00:24:32",
            "deleted_at": null,
            "channel": {
              "id": 1,
              "name": "Site",
              "text_hint": "Cole aqui a URL do ve√≠culo, se houver. √â um item importante para n√≥s, e nos ajudar√° na valida√ß√£o de sua sugest√£o - mas entendemos que alguns ve√≠culos nem site t√™m, por isso n√£o √© obrigat√≥rio. Agradecemos o esfor√ßo!",
              "created_at": "2019-10-29 00:21:45",
              "updated_at": "2019-10-29 00:21:45",
              "deleted_at": null
            }
          },
          {
            "id": 1100,
            "channel_id": 2,
            "link": "https:\/\/twitter.com\/agazetadoacre",
            "media_id": 5114,
            "created_at": "2019-10-29 00:24:32",
            "updated_at": "2019-10-29 00:24:32",
            "deleted_at": null,
            "channel": {
              "id": 2,
              "name": "Twitter",
              "text_hint": "Se houver, favor colocar link direto para a conta - se souber apenas o nome (ex. @observat√≥rio), acrescente antes https:\/\/twitter.com\/@nome  da pagina",
              "created_at": "2019-10-29 00:21:45",
              "updated_at": "2019-10-29 00:21:45",
              "deleted_at": null
            }
          },
          {
            "id": 1653,
            "channel_id": 3,
            "link": "https:\/\/www.facebook.com\/A-Gazeta-do-Acre-208579685881525\/",
            "media_id": 5114,
            "created_at": "2019-10-29 00:24:32",
            "updated_at": "2019-10-29 00:24:32",
            "deleted_at": null,
            "channel": {
              "id": 3,
              "name": "Facebook",
              "text_hint": "Se houver, favor colocar link direto para a conta - se souber apenas o nome (ex. @observat√≥rio), acrescente antes https:\/\/facebook.com\/@nome  da pagin",
              "created_at": "2019-10-29 00:21:45",
              "updated_at": "2019-10-29 00:21:45",
              "deleted_at": null
            }
          }
        ]
      }
    ]
</code></pre></div></div>

<h4 id="abaixo-o-que-cada-coluna-representa">Abaixo o que cada coluna representa</h4>

<table>
  <thead>
    <tr>
      <th>COLUNA</th>
      <th>VALOR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>id</td>
      <td>Identifica√ß√£o do ve√≠culo</td>
    </tr>
    <tr>
      <td>nome_veiculo</td>
      <td>Nome do ve√≠culo</td>
    </tr>
    <tr>
      <td>fonte</td>
      <td>Em qual plataforma esses dados foram inputados</td>
    </tr>
    <tr>
      <td>segmento</td>
      <td>Segmento principal</td>
    </tr>
    <tr>
      <td>cidade</td>
      <td>Cidade onde est√° o ve√≠culo</td>
    </tr>
    <tr>
      <td>cod_mun_ibge</td>
      <td>C√≥digo do munic√≠pio no IBGE</td>
    </tr>
    <tr>
      <td>estado</td>
      <td>Estado do ve√≠culo</td>
    </tr>
    <tr>
      <td>regiao</td>
      <td>Regi√£o do ve√≠culo</td>
    </tr>
    <tr>
      <td>address</td>
      <td>Endere√ßo do ve√≠culo</td>
    </tr>
    <tr>
      <td>annotations</td>
      <td>Observa√ß√µes sobre o ve√≠culo</td>
    </tr>
    <tr>
      <td>email</td>
      <td>Email do ve√≠culo</td>
    </tr>
    <tr>
      <td>num_funcionarios</td>
      <td>N√∫mero de funcion√°rios do ve√≠culo</td>
    </tr>
    <tr>
      <td>periodicity</td>
      <td>Periodicidade do ve√≠culo</td>
    </tr>
    <tr>
      <td>another_periodicity</td>
      <td>Se a periodicidade for diferente das dispon√≠veis, esse campo vai conter o texto explicando.</td>
    </tr>
    <tr>
      <td>eh_jornal</td>
      <td>Diz se o ve√≠culo √© um jornal. 1 - Sim, 0 - N√£o</td>
    </tr>
    <tr>
      <td>eh_site_pago</td>
      <td>Diz se o ve√≠culo √© financiado por algu√©m. 1 - Sim, 0 - N√£o</td>
    </tr>
    <tr>
      <td>data_fechamento</td>
      <td>Se houver data de fechamento, aqui ela estar√° descrita.</td>
    </tr>
    <tr>
      <td>business_models</td>
      <td>Modelos de neg√≥cios do ve√≠culo. Poder ter de 0 a n. (Array)</td>
    </tr>
    <tr>
      <td>features</td>
      <td>Caracter√≠sticas do ve√≠culo. Poder ter de 0 a n. (Array)</td>
    </tr>
    <tr>
      <td>collaborators</td>
      <td>Tipos de colaboradores que contribu√≠ram par aos dados do ve√≠culo. Poder ter de 0 a n. (Array)</td>
    </tr>
    <tr>
      <td>media_channels</td>
      <td>Canais de m√≠dia do ve√≠culo. Poder ter de 0 a n. (Array)</td>
    </tr>
    <tr>
      <td>media_channels.n.channel</td>
      <td>Defini√ß√£o do canal de m√≠dia do ve√≠culo</td>
    </tr>
  </tbody>
</table>

<hr />

<h3 id="cidades-sem-ve√≠culos-agrupamento-por-regi√£o">Cidades sem ve√≠culos (agrupamento por regi√£o)</h3>

<p>Endpoint que retorna um agregado com a quantidade de cidades sem ve√≠culos por regi√£o.</p>

<p>Esse √© o principal endpoint, que devolve todas as colunas brutas do nosso banco de dados.</p>

<h4 id="endere√ßo">Endere√ßo</h4>
<p>Retorna os dados:</p>

<p>GET: /data/qtd-cities-without-media-region</p>

<p>Retorna as defini√ß√µes:</p>

<p>GET: /data/qtd-cities-without-media-region/definitions</p>

<p>Retorno (Defini√ß√µes):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    [
      "regiao",
      "qtd_cidades",
      "qtd_desertos"
    ]
</code></pre></div></div>

<p>Retorno do endpoint</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    [
      {
        "regiao": "Centro-Oeste",
        "qtd_cidades": 467,
        "qtd_desertos": 224
      },
      {
        "regiao": "Nordeste",
        "qtd_cidades": 1794,
        "qtd_desertos": 1146
      },
      {
        "regiao": "Norte",
        "qtd_cidades": 450,
        "qtd_desertos": 315
      },
      {
        "regiao": "Sudeste",
        "qtd_cidades": 1668,
        "qtd_desertos": 633
      },
      {
        "regiao": "Sul",
        "qtd_cidades": 1191,
        "qtd_desertos": 544
      }
    ]
</code></pre></div></div>
:ET